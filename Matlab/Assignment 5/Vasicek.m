function rtnVasicek = Vasicek(currentPeriod, previousPeriod, parameters, timePeriod)
% Return the expanded formula  

    % Get values from input parameters
    a=parameters(1);
    b=parameters(2);
    c=parameters(3);
    h=timePeriod;

    % Define the 
    rtnVasicek = (70368744177664*exp(-(currentPeriod - previousPeriod)^2/(2*c^2*h))*(390*a^6*b^4*c^4*h^4 - 780*a^6*b^4*c^2*h^3*currentPeriod^2 + 1560*a^6*b^4*c^2*h^3*currentPeriod*previousPeriod - 780*a^6*b^4*c^2*h^3*previousPeriod^2 + 130*a^6*b^4*h^2*currentPeriod^4 - 520*a^6*b^4*h^2*currentPeriod^3*previousPeriod + 780*a^6*b^4*h^2*currentPeriod^2*previousPeriod^2 - 520*a^6*b^4*h^2*currentPeriod*previousPeriod^3 + 130*a^6*b^4*h^2*previousPeriod^4 + 540*a^6*b^3*c^4*h^4*currentPeriod - 2100*a^6*b^3*c^4*h^4*previousPeriod - 180*a^6*b^3*c^2*h^3*currentPeriod^3 + 3660*a^6*b^3*c^2*h^3*currentPeriod^2*previousPeriod - 6780*a^6*b^3*c^2*h^3*currentPeriod*previousPeriod^2 + 3300*a^6*b^3*c^2*h^3*previousPeriod^3 - 520*a^6*b^3*h^2*currentPeriod^4*previousPeriod + 2080*a^6*b^3*h^2*currentPeriod^3*previousPeriod^2 - 3120*a^6*b^3*h^2*currentPeriod^2*previousPeriod^3 + 2080*a^6*b^3*h^2*currentPeriod*previousPeriod^4 - 520*a^6*b^3*h^2*previousPeriod^5 - 155*a^6*b^2*c^6*h^5 + 248*a^6*b^2*c^4*h^4*currentPeriod^2 - 2116*a^6*b^2*c^4*h^4*currentPeriod*previousPeriod + 4208*a^6*b^2*c^4*h^4*previousPeriod^2 - 31*a^6*b^2*c^2*h^3*currentPeriod^4 + 664*a^6*b^2*c^2*h^3*currentPeriod^3*previousPeriod - 6486*a^6*b^2*c^2*h^3*currentPeriod^2*previousPeriod^2 + 11104*a^6*b^2*c^2*h^3*currentPeriod*previousPeriod^3 - 5251*a^6*b^2*c^2*h^3*previousPeriod^4 + 780*a^6*b^2*h^2*currentPeriod^4*previousPeriod^2 - 3120*a^6*b^2*h^2*currentPeriod^3*previousPeriod^3 + 4680*a^6*b^2*h^2*currentPeriod^2*previousPeriod^4 - 3120*a^6*b^2*h^2*currentPeriod*previousPeriod^5 + 780*a^6*b^2*h^2*previousPeriod^6 - 5*a^6*b*c^6*h^5*currentPeriod + 315*a^6*b*c^6*h^5*previousPeriod + a^6*b*c^4*h^4*currentPeriod^3 - 499*a^6*b*c^4*h^4*currentPeriod^2*previousPeriod + 2615*a^6*b*c^4*h^4*currentPeriod*previousPeriod^2 - 3677*a^6*b*c^4*h^4*previousPeriod^3 + 62*a^6*b*c^2*h^3*currentPeriod^4*previousPeriod - 788*a^6*b*c^2*h^3*currentPeriod^3*previousPeriod^2 + 5112*a^6*b*c^2*h^3*currentPeriod^2*previousPeriod^3 - 8108*a^6*b*c^2*h^3*currentPeriod*previousPeriod^4 + 3722*a^6*b*c^2*h^3*previousPeriod^5 - 520*a^6*b*h^2*currentPeriod^4*previousPeriod^3 + 2080*a^6*b*h^2*currentPeriod^3*previousPeriod^4 - 3120*a^6*b*h^2*currentPeriod^2*previousPeriod^5 + 2080*a^6*b*h^2*currentPeriod*previousPeriod^6 - 520*a^6*b*h^2*previousPeriod^7 + 5*a^6*c^6*h^5*currentPeriod*previousPeriod - 160*a^6*c^6*h^5*previousPeriod^2 - a^6*c^4*h^4*currentPeriod^3*previousPeriod + 251*a^6*c^4*h^4*currentPeriod^2*previousPeriod^2 - 1039*a^6*c^4*h^4*currentPeriod*previousPeriod^3 + 1179*a^6*c^4*h^4*previousPeriod^4 - 31*a^6*c^2*h^3*currentPeriod^4*previousPeriod^2 + 304*a^6*c^2*h^3*currentPeriod^3*previousPeriod^3 - 1506*a^6*c^2*h^3*currentPeriod^2*previousPeriod^4 + 2224*a^6*c^2*h^3*currentPeriod*previousPeriod^5 - 991*a^6*c^2*h^3*previousPeriod^6 + 130*a^6*h^2*currentPeriod^4*previousPeriod^4 - 520*a^6*h^2*currentPeriod^3*previousPeriod^5 + 780*a^6*h^2*currentPeriod^2*previousPeriod^6 - 520*a^6*h^2*currentPeriod*previousPeriod^7 + 130*a^6*h^2*previousPeriod^8 - 360*a^5*b^4*c^4*h^3 + 720*a^5*b^4*c^2*h^2*currentPeriod^2 - 1440*a^5*b^4*c^2*h^2*currentPeriod*previousPeriod + 720*a^5*b^4*c^2*h^2*previousPeriod^2 - 120*a^5*b^4*h*currentPeriod^4 + 480*a^5*b^4*h*currentPeriod^3*previousPeriod - 720*a^5*b^4*h*currentPeriod^2*previousPeriod^2 + 480*a^5*b^4*h*currentPeriod*previousPeriod^3 - 120*a^5*b^4*h*previousPeriod^4 - 900*a^5*b^3*c^4*h^3*currentPeriod + 2340*a^5*b^3*c^4*h^3*previousPeriod + 300*a^5*b^3*c^2*h^2*currentPeriod^3 - 3780*a^5*b^3*c^2*h^2*currentPeriod^2*previousPeriod + 6660*a^5*b^3*c^2*h^2*currentPeriod*previousPeriod^2 - 3180*a^5*b^3*c^2*h^2*previousPeriod^3 + 480*a^5*b^3*h*currentPeriod^4*previousPeriod - 1920*a^5*b^3*h*currentPeriod^3*previousPeriod^2 + 2880*a^5*b^3*h*currentPeriod^2*previousPeriod^3 - 1920*a^5*b^3*h*currentPeriod*previousPeriod^4 + 480*a^5*b^3*h*previousPeriod^5 - 1530*a^5*b^2*c^6*h^4 + 3240*a^5*b^2*c^4*h^3*currentPeriod^2 - 3780*a^5*b^2*c^4*h^3*currentPeriod*previousPeriod - 1620*a^5*b^2*c^4*h^3*previousPeriod^2 - 570*a^5*b^2*c^2*h^2*currentPeriod^4 + 1380*a^5*b^2*c^2*h^2*currentPeriod^3*previousPeriod + 3600*a^5*b^2*c^2*h^2*currentPeriod^2*previousPeriod^2 - 9060*a^5*b^2*c^2*h^2*currentPeriod*previousPeriod^3 + 4650*a^5*b^2*c^2*h^2*previousPeriod^4 - 720*a^5*b^2*h*currentPeriod^4*previousPeriod^2 + 2880*a^5*b^2*h*currentPeriod^3*previousPeriod^3 - 4320*a^5*b^2*h*currentPeriod^2*previousPeriod^4 + 2880*a^5*b^2*h*currentPeriod*previousPeriod^5 - 720*a^5*b^2*h*previousPeriod^6 - 966*a^5*b*c^6*h^4*currentPeriod + 4026*a^5*b*c^6*h^4*previousPeriod + 326*a^5*b*c^4*h^3*currentPeriod^3 - 7458*a^5*b*c^4*h^3*currentPeriod^2*previousPeriod + 11238*a^5*b*c^4*h^3*currentPeriod*previousPeriod^2 - 2666*a^5*b*c^4*h^3*previousPeriod^3 + 1140*a^5*b*c^2*h^2*currentPeriod^4*previousPeriod - 3660*a^5*b*c^2*h^2*currentPeriod^3*previousPeriod^2 + 1260*a^5*b*c^2*h^2*currentPeriod^2*previousPeriod^3 + 3900*a^5*b*c^2*h^2*currentPeriod*previousPeriod^4 - 2640*a^5*b*c^2*h^2*previousPeriod^5 + 480*a^5*b*h*currentPeriod^4*previousPeriod^3 - 1920*a^5*b*h*currentPeriod^3*previousPeriod^4 + 2880*a^5*b*h*currentPeriod^2*previousPeriod^5 - 1920*a^5*b*h*currentPeriod*previousPeriod^6 + 480*a^5*b*h*previousPeriod^7 + 80*a^5*c^8*h^5 - 128*a^5*c^6*h^4*currentPeriod^2 + 1222*a^5*c^6*h^4*currentPeriod*previousPeriod - 2624*a^5*c^6*h^4*previousPeriod^2 + 16*a^5*c^4*h^3*currentPeriod^4 - 390*a^5*c^4*h^3*currentPeriod^3*previousPeriod + 4314*a^5*c^4*h^3*currentPeriod^2*previousPeriod^2 - 6622*a^5*c^4*h^3*currentPeriod*previousPeriod^3 + 2322*a^5*c^4*h^3*previousPeriod^4 - 570*a^5*c^2*h^2*currentPeriod^4*previousPeriod^2 + 1980*a^5*c^2*h^2*currentPeriod^3*previousPeriod^3 - 1800*a^5*c^2*h^2*currentPeriod^2*previousPeriod^4 - 60*a^5*c^2*h^2*currentPeriod*previousPeriod^5 + 450*a^5*c^2*h^2*previousPeriod^6 - 120*a^5*h*currentPeriod^4*previousPeriod^4 + 480*a^5*h*currentPeriod^3*previousPeriod^5 - 720*a^5*h*currentPeriod^2*previousPeriod^6 + 480*a^5*h*currentPeriod*previousPeriod^7 - 120*a^5*h*previousPeriod^8 + 180*a^4*b^4*c^4*h^2 - 360*a^4*b^4*c^2*h*currentPeriod^2 + 720*a^4*b^4*c^2*h*currentPeriod*previousPeriod - 360*a^4*b^4*c^2*h*previousPeriod^2 + 60*a^4*b^4*currentPeriod^4 - 240*a^4*b^4*currentPeriod^3*previousPeriod + 360*a^4*b^4*currentPeriod^2*previousPeriod^2 - 240*a^4*b^4*currentPeriod*previousPeriod^3 + 60*a^4*b^4*previousPeriod^4 + 1080*a^4*b^3*c^4*h^2*currentPeriod - 1800*a^4*b^3*c^4*h^2*previousPeriod - 360*a^4*b^3*c^2*h*currentPeriod^3 + 2520*a^4*b^3*c^2*h*currentPeriod^2*previousPeriod - 3960*a^4*b^3*c^2*h*currentPeriod*previousPeriod^2 + 1800*a^4*b^3*c^2*h*previousPeriod^3 - 240*a^4*b^3*currentPeriod^4*previousPeriod + 960*a^4*b^3*currentPeriod^3*previousPeriod^2 - 1440*a^4*b^3*currentPeriod^2*previousPeriod^3 + 960*a^4*b^3*currentPeriod*previousPeriod^4 - 240*a^4*b^3*previousPeriod^5 + 1380*a^4*b^2*c^6*h^3 - 3180*a^4*b^2*c^4*h^2*currentPeriod^2 + 3120*a^4*b^2*c^4*h^2*currentPeriod*previousPeriod + 1140*a^4*b^2*c^4*h^2*previousPeriod^2 + 600*a^4*b^2*c^2*h*currentPeriod^4 - 1320*a^4*b^2*c^2*h*currentPeriod^3*previousPeriod - 1800*a^4*b^2*c^2*h*currentPeriod^2*previousPeriod^2 + 5160*a^4*b^2*c^2*h*currentPeriod*previousPeriod^3 - 2640*a^4*b^2*c^2*h*previousPeriod^4 + 360*a^4*b^2*currentPeriod^4*previousPeriod^2 - 1440*a^4*b^2*currentPeriod^3*previousPeriod^3 + 2160*a^4*b^2*currentPeriod^2*previousPeriod^4 - 1440*a^4*b^2*currentPeriod*previousPeriod^5 + 360*a^4*b^2*previousPeriod^6 + 1740*a^4*b*c^6*h^3*currentPeriod - 4500*a^4*b*c^6*h^3*previousPeriod - 600*a^4*b*c^4*h^2*currentPeriod^3 + 8160*a^4*b*c^4*h^2*currentPeriod^2*previousPeriod - 11280*a^4*b*c^4*h^2*currentPeriod*previousPeriod^2 + 3000*a^4*b*c^4*h^2*previousPeriod^3 - 1200*a^4*b*c^2*h*currentPeriod^4*previousPeriod + 3720*a^4*b*c^2*h*currentPeriod^3*previousPeriod^2 - 2520*a^4*b*c^2*h*currentPeriod^2*previousPeriod^3 - 1320*a^4*b*c^2*h*currentPeriod*previousPeriod^4 + 1320*a^4*b*c^2*h*previousPeriod^5 - 240*a^4*b*currentPeriod^4*previousPeriod^3 + 960*a^4*b*currentPeriod^3*previousPeriod^4 - 1440*a^4*b*currentPeriod^2*previousPeriod^5 + 960*a^4*b*currentPeriod*previousPeriod^6 - 240*a^4*b*previousPeriod^7 + 504*a^4*c^8*h^4 - 1104*a^4*c^6*h^3*currentPeriod^2 + 468*a^4*c^6*h^3*currentPeriod*previousPeriod + 2016*a^4*c^6*h^3*previousPeriod^2 + 200*a^4*c^4*h^2*currentPeriod^4 - 200*a^4*c^4*h^2*currentPeriod^3*previousPeriod - 3780*a^4*c^4*h^2*currentPeriod^2*previousPeriod^2 + 6280*a^4*c^4*h^2*currentPeriod*previousPeriod^3 - 2320*a^4*c^4*h^2*previousPeriod^4 + 600*a^4*c^2*h*currentPeriod^4*previousPeriod^2 - 2040*a^4*c^2*h*currentPeriod^3*previousPeriod^3 + 2160*a^4*c^2*h*currentPeriod^2*previousPeriod^4 - 600*a^4*c^2*h*currentPeriod*previousPeriod^5 - 120*a^4*c^2*h*previousPeriod^6 + 60*a^4*currentPeriod^4*previousPeriod^4 - 240*a^4*currentPeriod^3*previousPeriod^5 + 360*a^4*currentPeriod^2*previousPeriod^6 - 240*a^4*currentPeriod*previousPeriod^7 + 60*a^4*previousPeriod^8 - 720*a^3*b^3*c^4*h*currentPeriod + 720*a^3*b^3*c^4*h*previousPeriod + 240*a^3*b^3*c^2*currentPeriod^3 - 720*a^3*b^3*c^2*currentPeriod^2*previousPeriod + 720*a^3*b^3*c^2*currentPeriod*previousPeriod^2 - 240*a^3*b^3*c^2*previousPeriod^3 - 360*a^3*b^2*c^6*h^2 + 1440*a^3*b^2*c^4*h*currentPeriod^2 - 720*a^3*b^2*c^4*h*currentPeriod*previousPeriod - 720*a^3*b^2*c^4*h*previousPeriod^2 - 360*a^3*b^2*c^2*currentPeriod^4 + 720*a^3*b^2*c^2*currentPeriod^3*previousPeriod - 720*a^3*b^2*c^2*currentPeriod*previousPeriod^3 + 360*a^3*b^2*c^2*previousPeriod^4 - 2280*a^3*b*c^6*h^2*currentPeriod + 3000*a^3*b*c^6*h^2*previousPeriod + 840*a^3*b*c^4*h*currentPeriod^3 - 5400*a^3*b*c^4*h*currentPeriod^2*previousPeriod + 6120*a^3*b*c^4*h*currentPeriod*previousPeriod^2 - 1560*a^3*b*c^4*h*previousPeriod^3 + 720*a^3*b*c^2*currentPeriod^4*previousPeriod - 2160*a^3*b*c^2*currentPeriod^3*previousPeriod^2 + 2160*a^3*b*c^2*currentPeriod^2*previousPeriod^3 - 720*a^3*b*c^2*currentPeriod*previousPeriod^4 - 480*a^3*c^8*h^3 + 1200*a^3*c^6*h^2*currentPeriod^2 - 120*a^3*c^6*h^2*currentPeriod*previousPeriod - 1440*a^3*c^6*h^2*previousPeriod^2 - 240*a^3*c^4*h*currentPeriod^4 + 120*a^3*c^4*h*currentPeriod^3*previousPeriod + 2520*a^3*c^4*h*currentPeriod^2*previousPeriod^2 - 3720*a^3*c^4*h*currentPeriod*previousPeriod^3 + 1320*a^3*c^4*h*previousPeriod^4 - 360*a^3*c^2*currentPeriod^4*previousPeriod^2 + 1200*a^3*c^2*currentPeriod^3*previousPeriod^3 - 1440*a^3*c^2*currentPeriod^2*previousPeriod^4 + 720*a^3*c^2*currentPeriod*previousPeriod^5 - 120*a^3*c^2*previousPeriod^6 - 720*a^2*b^2*c^6*h + 720*a^2*b^2*c^4*currentPeriod^2 - 1440*a^2*b^2*c^4*currentPeriod*previousPeriod + 720*a^2*b^2*c^4*previousPeriod^2 + 1440*a^2*b*c^6*h*currentPeriod - 720*a^2*b*c^4*currentPeriod^3 + 720*a^2*b*c^4*currentPeriod^2*previousPeriod + 720*a^2*b*c^4*currentPeriod*previousPeriod^2 - 720*a^2*b*c^4*previousPeriod^3 + 60*a^2*c^8*h^2 - 600*a^2*c^6*h*currentPeriod^2 - 240*a^2*c^6*h*currentPeriod*previousPeriod + 120*a^2*c^6*h*previousPeriod^2 + 180*a^2*c^4*currentPeriod^4 - 360*a^2*c^4*currentPeriod^2*previousPeriod^2 + 180*a^2*c^4*previousPeriod^4 + 1440*a*b*c^6*currentPeriod - 1440*a*b*c^6*previousPeriod + 720*a*c^8*h - 720*a*c^6*currentPeriod^2 + 720*a*c^6*previousPeriod^2 + 1440*c^8))/(253999128680651745*c^9*h^(1/2));

end